>>> START RUNNING: FedAVG-Equal-Non-IID-01-2.1.1 - Train mode: benchmark - Dataset: chexpert
START LOADING CHEXPERT DATASET...
n_params: 11177538
Init State dim 6
Init Action dim 3
ROUND:  0
[5, 5, 5]
len of flat tensor:  11177538
model.parameters: 62
count = 11177538
output: 62
model.state_dict().keys(): odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.downsample.0.weight', 'layer2.0.downsample.1.weight', 'layer2.0.downsample.1.bias', 'layer2.0.downsample.1.running_mean', 'layer2.0.downsample.1.running_var', 'layer2.0.downsample.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.downsample.0.weight', 'layer3.0.downsample.1.weight', 'layer3.0.downsample.1.bias', 'layer3.0.downsample.1.running_mean', 'layer3.0.downsample.1.running_var', 'layer3.0.downsample.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.downsample.0.weight', 'layer4.0.downsample.1.weight', 'layer4.0.downsample.1.bias', 'layer4.0.downsample.1.running_mean', 'layer4.0.downsample.1.running_var', 'layer4.0.downsample.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'fc.weight', 'fc.bias'])
len of model.state_dict().keys(): 122
name 0
param Parameter containing:
tensor([[[[ 2.3059e-02,  3.0951e-02,  1.2449e-02,  ...,  1.7937e-02,
            2.5598e-02, -1.5373e-02],
          [ 4.2125e-02, -2.8161e-02,  4.3665e-02,  ...,  7.0097e-03,
            3.4467e-02, -3.8728e-02],
          [-1.3308e-02, -7.0303e-03, -1.3362e-03,  ...,  1.8477e-02,
           -2.2680e-02, -1.2679e-02],
          ...,
          [-1.1737e-02, -2.8921e-02, -7.9844e-03,  ..., -3.9819e-03,
            7.8492e-03, -2.9409e-02],
          [ 1.3713e-02, -1.4094e-02, -8.9307e-03,  ...,  3.6694e-02,
            6.4555e-02, -1.0297e-02],
          [ 1.8951e-02,  2.6388e-02, -8.9128e-03,  ...,  1.2741e-03,
            4.5322e-03, -7.5538e-03]],
         [[-2.2733e-02, -6.2678e-03, -1.2294e-02,  ..., -1.8298e-02,
           -1.3824e-02,  1.9619e-03],
          [-9.7466e-03,  9.2964e-03,  1.7600e-02,  ..., -1.0785e-02,
           -1.5024e-02, -4.6074e-02],
          [-1.5025e-02,  2.6278e-02, -2.3635e-02,  ...,  3.1539e-02,
            3.0644e-02,  5.6922e-02],
          ...,
          [ 2.4672e-02,  2.9086e-02,  2.9594e-02,  ..., -3.6489e-02,
            2.8419e-02,  3.9936e-03],
          [-2.1870e-02,  2.8166e-02, -5.2010e-03,  ...,  2.7082e-04,
           -2.7112e-02, -2.3228e-02],
          [ 8.1197e-03,  1.2822e-02, -1.4520e-02,  ..., -6.7925e-03,
            1.2977e-02, -1.6140e-02]],
         [[-3.4070e-02, -2.7747e-03,  3.4780e-02,  ..., -2.2388e-02,
           -1.5248e-02, -1.0095e-02],
          [-1.1297e-02, -1.9928e-02, -2.4190e-02,  ..., -3.5125e-02,
           -2.8365e-02,  2.1930e-02],
          [-2.9280e-02, -4.2624e-02,  4.5234e-02,  ...,  9.4363e-03,
           -2.8617e-02,  1.8552e-02],
          ...,
          [ 2.3073e-02,  1.4758e-03,  1.9760e-02,  ...,  1.9053e-02,
           -2.3768e-02, -1.5698e-02],
          [ 2.8381e-03, -7.0434e-04, -6.5021e-02,  ...,  6.5782e-03,
           -2.8231e-02, -1.3242e-02],
          [-1.9512e-02, -1.7857e-03, -1.7297e-02,  ..., -8.3703e-03,
            6.9325e-02,  3.0088e-02]]],
        [[[-7.8232e-03, -1.3447e-02, -2.7615e-02,  ..., -2.4993e-02,
           -2.9436e-02,  1.0173e-02],
          [ 1.4154e-03, -2.0775e-02,  1.2708e-02,  ...,  4.5161e-02,
            1.4709e-02, -2.1342e-02],
          [-1.0781e-03,  9.2545e-03, -8.1733e-03,  ...,  3.0514e-02,
           -9.3028e-03, -1.5639e-02],
          ...,
          [-4.2622e-03, -2.6140e-02,  8.8914e-03,  ...,  3.5990e-02,
           -1.0634e-02, -1.6147e-02],
          [-4.1979e-02,  5.2367e-03, -4.9914e-03,  ...,  4.1238e-02,
           -2.8796e-02,  3.0859e-02],
          [-5.1380e-03, -4.2997e-02, -2.7060e-02,  ..., -2.2165e-03,
           -3.8053e-02,  1.6574e-02]],
         [[ 1.5687e-02,  8.5917e-03, -3.3689e-02,  ..., -1.3280e-03,
           -6.9561e-03, -5.4444e-03],
          [-2.4681e-02, -4.6991e-03, -1.0199e-02,  ..., -4.0114e-02,
            2.6489e-02,  3.1542e-02],
          [-3.2253e-02,  1.2430e-03, -4.2087e-02,  ..., -2.1655e-02,
           -1.4072e-02,  1.4254e-02],
          ...,
          [ 4.0122e-02,  1.3414e-03, -1.1973e-02,  ..., -3.8478e-02,
            1.0116e-02, -3.5702e-02],
          [-1.8737e-03, -1.9892e-02, -1.3514e-02,  ...,  1.7311e-02,
            1.9452e-02,  9.1304e-03],
          [ 1.0803e-02,  1.2040e-02, -3.9487e-02,  ...,  2.6275e-02,
           -6.4384e-03, -1.4458e-02]],
         [[ 1.0514e-02,  1.6778e-02, -3.4588e-02,  ..., -2.5942e-02,
           -2.4988e-02, -6.3626e-04],
          [-6.3428e-03, -3.5664e-02,  1.9541e-03,  ...,  1.6889e-02,
           -1.9402e-02, -4.4228e-02],
          [-2.2370e-02, -2.1177e-02, -1.3196e-02,  ..., -4.6157e-02,
           -1.6031e-02,  6.7572e-03],
          ...,
          [-3.0799e-03, -2.1925e-02,  6.2510e-03,  ..., -3.4025e-02,
            3.8074e-02, -3.8531e-03],
          [ 3.0571e-02,  3.0861e-02,  1.0720e-02,  ..., -3.1009e-02,
           -1.6531e-02, -1.5405e-02],
          [-1.6444e-02,  1.1217e-02, -4.9168e-03,  ...,  1.3029e-02,
           -2.0437e-02,  1.3336e-02]]],
        [[[ 5.7551e-02, -6.4841e-03, -2.4997e-02,  ...,  2.1892e-02,
           -1.9219e-02, -3.2680e-04],
          [ 2.1282e-02, -5.0845e-03,  1.9689e-02,  ..., -2.4578e-02,
            2.9545e-02,  2.2250e-02],
          [-2.8381e-02, -1.6785e-02,  1.0667e-02,  ..., -7.8620e-03,
            7.7932e-03, -1.2193e-02],
          ...,
          [-3.1206e-02,  2.9947e-02,  9.7224e-04,  ...,  1.8600e-02,
            2.8682e-05, -1.5680e-02],
          [-3.9544e-02, -3.4976e-02, -4.3813e-02,  ..., -2.1005e-03,
           -2.5872e-02, -3.5825e-02],
          [-2.5835e-02,  3.5735e-03, -2.1550e-02,  ..., -7.3994e-03,
            5.1741e-03,  1.1752e-03]],
         [[-2.2525e-02, -2.3582e-02, -3.5724e-02,  ..., -2.1130e-02,
            1.4191e-02, -2.6013e-02],
          [-9.2726e-03,  1.5170e-02,  3.1060e-02,  ...,  4.1380e-02,
           -1.2527e-02,  1.3493e-02],
          [ 1.9816e-02, -1.5556e-02, -1.8289e-02,  ..., -7.7188e-02,
           -4.5927e-02, -2.0579e-02],
          ...,
          [-3.7139e-02,  2.2678e-02,  1.3194e-02,  ...,  1.8060e-02,
           -2.0755e-02, -2.9960e-02],
          [-6.5841e-03,  2.1277e-02,  1.8023e-02,  ...,  9.7242e-03,
            3.4852e-02, -2.3483e-02],
          [ 2.3324e-02, -3.2861e-02,  5.4410e-03,  ..., -1.0724e-02,
            3.8081e-03,  2.8336e-02]],
         [[ 2.2866e-03,  3.3686e-02, -6.6059e-03,  ..., -2.0448e-02,
            9.5668e-03, -1.2968e-02],
          [ 7.0418e-03, -1.7610e-02, -9.9337e-03,  ...,  4.0670e-02,
            3.4191e-02, -8.4938e-03],
          [ 1.6172e-03, -4.1006e-04, -1.4662e-02,  ...,  3.3491e-02,
           -6.5304e-03,  4.4856e-02],
          ...,
          [ 2.1694e-02, -8.4159e-02,  9.0445e-04,  ..., -1.6605e-02,
           -3.7896e-03, -2.8450e-02],
          [ 2.4596e-02, -3.9211e-02, -1.2994e-02,  ...,  1.3740e-02,
            2.7981e-02,  1.2206e-02],
          [ 1.6221e-02,  5.8400e-03,  7.1653e-03,  ...,  2.7316e-02,
           -1.8583e-02,  5.5079e-03]]],
        ...,
        [[[ 3.0863e-02,  5.3879e-02,  4.5101e-02,  ...,  4.7875e-02,
            6.4948e-02,  2.6823e-02],
          [-2.3110e-02, -2.0716e-02, -1.9470e-02,  ...,  1.2074e-02,
            9.7801e-03,  3.4403e-02],
          [ 1.4508e-02,  7.2759e-03,  1.7734e-02,  ..., -1.3231e-02,
           -4.5950e-02, -1.9992e-02],
          ...,
          [-2.4613e-03, -3.6698e-03, -2.9951e-02,  ..., -4.8054e-03,
           -3.2645e-02,  3.8818e-02],
          [-5.5440e-02, -1.5782e-02,  7.0954e-03,  ...,  4.7318e-02,
           -7.5687e-03, -4.9103e-02],
          [-1.4677e-02, -8.8116e-03,  3.0007e-02,  ...,  6.3280e-03,
            1.5555e-02,  3.6879e-02]],
         [[-1.0933e-02, -1.2784e-02, -1.0964e-02,  ...,  1.4467e-02,
           -2.3068e-03,  1.2317e-02],
          [-2.8320e-02, -3.6945e-03, -1.5578e-02,  ..., -3.6211e-02,
            3.5331e-02,  2.0247e-02],
          [ 2.0414e-02, -8.8432e-03,  2.0310e-02,  ..., -1.2430e-02,
            1.4246e-02, -1.5327e-02],
          ...,
          [-9.8311e-03,  2.3928e-02,  1.2718e-02,  ..., -1.7355e-02,
            1.1374e-02,  2.0870e-02],
          [ 4.7166e-02, -1.0481e-02,  1.0671e-02,  ...,  2.9830e-02,
           -3.1255e-03, -2.9330e-02],
          [ 1.6544e-02,  2.6064e-02,  1.6634e-02,  ..., -2.2782e-02,
            2.9172e-02, -4.7173e-02]],
         [[ 1.2066e-02,  1.5250e-02, -1.6167e-02,  ...,  4.0022e-02,
           -2.8429e-02, -5.1846e-03],
          [-2.7944e-02,  2.4418e-02,  2.1856e-02,  ...,  2.3538e-02,
           -1.4656e-02,  1.2277e-02],
          [ 2.0368e-02,  2.8016e-02, -2.3150e-04,  ..., -4.1611e-02,
            1.8349e-02, -3.1001e-02],
          ...,
          [ 2.0445e-02, -6.7510e-04,  3.4125e-02,  ..., -2.2997e-02,
           -2.0792e-03,  2.2623e-02],
          [-1.2493e-02,  2.8742e-02, -1.4444e-03,  ...,  2.7895e-02,
           -4.0087e-03,  2.2105e-02],
          [-2.3584e-04, -2.1335e-03,  1.5595e-02,  ..., -1.5021e-02,
           -1.5640e-03,  2.0673e-02]]],
        [[[-1.7371e-02,  1.5942e-02, -1.2939e-02,  ..., -3.6070e-03,
            1.5212e-02, -3.2320e-02],
          [ 2.4866e-02, -3.5204e-02,  1.2509e-02,  ..., -4.2307e-02,
           -1.9120e-02, -1.5248e-02],
          [-4.0297e-02, -1.8485e-03,  1.2441e-02,  ...,  2.1098e-03,
            2.5362e-02, -2.1301e-02],
          ...,
          [-1.8142e-02,  9.6618e-03, -1.7613e-02,  ..., -2.1544e-02,
            4.0009e-03,  1.5099e-03],
          [ 2.8379e-02, -4.3830e-02,  1.5703e-02,  ...,  1.6652e-03,
           -1.9002e-02,  1.7324e-02],
          [ 4.8455e-03,  5.4650e-02, -1.4401e-02,  ...,  7.2427e-03,
           -1.0421e-03,  3.2705e-02]],
         [[ 8.4019e-03,  5.8347e-03, -1.7871e-02,  ...,  1.8295e-02,
           -1.2002e-03, -3.7119e-02],
          [-7.8367e-04,  1.6308e-02, -2.1474e-02,  ..., -8.1273e-03,
            9.7558e-03,  7.0285e-04],
          [-3.9956e-03,  3.3750e-02, -2.8397e-03,  ..., -1.1561e-02,
            2.5814e-02,  2.3270e-02],
          ...,
          [ 1.5488e-02,  1.2762e-02,  2.6344e-03,  ...,  4.5979e-02,
            1.1141e-02,  1.5428e-02],
          [-1.7825e-02,  5.2247e-03,  1.9555e-02,  ...,  1.0461e-02,
           -9.5291e-03,  3.3946e-02],
          [ 6.9190e-04,  3.2525e-03,  1.8652e-02,  ...,  2.0463e-02,
            4.2677e-02,  2.3614e-02]],
         [[ 2.0927e-02, -1.1075e-04,  1.8184e-02,  ...,  9.4356e-03,
           -3.0071e-02,  3.5395e-03],
          [-5.7791e-03, -5.7612e-03, -2.5036e-02,  ..., -5.6519e-04,
            4.5197e-03, -1.0847e-02],
          [-8.1316e-03,  1.7389e-02,  4.3251e-02,  ..., -1.7857e-03,
           -1.8680e-02, -1.1176e-03],
          ...,
          [-1.4717e-02, -1.9986e-02,  1.9215e-02,  ...,  2.8843e-03,
            2.0868e-02, -3.0933e-02],
          [-1.8952e-02, -8.0956e-03,  3.6314e-02,  ..., -4.4599e-02,
           -3.1141e-02,  1.6228e-02],
          [-1.2116e-02,  1.6571e-02,  3.5533e-02,  ...,  7.5617e-03,
            1.8938e-02,  3.9335e-02]]],
        [[[ 1.1649e-02,  3.2280e-03, -2.3600e-02,  ..., -3.5705e-02,
            2.1155e-02,  1.4970e-02],
          [-9.9773e-03,  4.6803e-02, -2.1430e-02,  ...,  4.0943e-03,
           -3.3178e-02, -2.1619e-03],
          [ 2.5859e-02, -5.3988e-02,  1.2623e-02,  ..., -4.2154e-02,
           -1.2413e-02, -4.9755e-03],
          ...,
          [-2.3735e-02,  5.3067e-02,  1.1310e-02,  ..., -3.3984e-02,
            2.1838e-02,  9.5275e-03],
          [-2.2593e-02,  1.5484e-02, -1.8170e-02,  ...,  1.0532e-02,
            2.0852e-02,  9.6412e-03],
          [-2.3035e-03, -1.2063e-03,  9.6454e-03,  ..., -3.1695e-02,
            3.1347e-03,  2.6838e-02]],
         [[-2.8888e-02,  2.0934e-03,  2.1415e-02,  ...,  4.0037e-02,
           -5.5849e-03, -3.9048e-02],
          [ 2.4072e-02,  4.6746e-02, -3.4808e-02,  ..., -3.2380e-02,
            1.6590e-02,  2.8378e-02],
          [-7.0085e-03,  1.8259e-03,  3.5469e-03,  ...,  4.1621e-02,
           -3.5471e-03,  4.3412e-02],
          ...,
          [-9.8950e-03, -2.1789e-02,  5.9109e-03,  ...,  6.0141e-04,
            4.2373e-02, -2.6926e-03],
          [-1.5618e-02,  2.1578e-02,  3.4155e-02,  ..., -1.6515e-02,
            5.6746e-03,  9.2455e-03],
          [ 2.1206e-02,  1.3673e-02,  2.6717e-02,  ...,  3.5866e-02,
            3.7869e-02, -3.9289e-02]],
         [[ 7.6137e-03, -3.5118e-02,  1.8476e-02,  ..., -4.6292e-03,
           -3.5669e-02,  1.9743e-02],
          [-8.0007e-03, -2.8059e-02,  1.1658e-02,  ...,  3.4706e-02,
           -1.7465e-02, -2.3567e-02],
          [ 3.2413e-02, -5.1784e-04,  1.9352e-02,  ...,  4.1648e-02,
           -2.2160e-02, -9.8585e-03],
          ...,
          [ 1.3738e-02, -1.2020e-02, -8.5972e-03,  ..., -3.5801e-02,
            1.6789e-02,  5.4443e-02],
          [ 2.2874e-02,  5.3693e-03, -2.4906e-02,  ...,  2.1404e-02,
           -1.7681e-03,  1.8955e-03],
          [ 5.8963e-02,  4.0234e-02,  2.0694e-02,  ...,  1.0688e-02,
            3.8812e-02, -1.3881e-02]]]], requires_grad=True)
  0%|                                                                    | 0/1000 [01:23<?, ?it/s]
Traceback (most recent call last):
  File "train.py", line 345, in <module>
    main(args)
  File "train.py", line 261, in main
    client_model.load_state_dict(unflatten_model(flat_tensor, client_model))
  File "/mnt/disk1/dungnt-vaipe/federated-learning-dqn/utils/utils.py", line 164, in unflatten_model
    name[j] = output[i]
NameError: name 'i' is not defined